<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <style media="screen">
    #github{
      background-image: url(res/channels/github/github.svg);
      background-color: #28282B;
      background-position: center;
      background-size: contain;
      background-repeat: no-repeat;
    }
  </style>
  <link rel="stylesheet" href="res/index.css">
</head>
<body>
  <svg style="position:absolute; z-index: -1; display:hidden; width: 1px; height:1px">
    <defs>
      <clipPath id="channelClip" clipPathUnits="objectBoundingBox">
         <path d="
         m 0.5,0 
         C 0.6,0 0.87,0 0.94,0.014
         C 1,0.026 1,0.13 1,0.5 
         C 1,0.87 1,0.974 0.94,0.986 
         C 0.87,1 0.6,1 0.5,1 
         C 0.4,1 0.13,1 0.06,0.986 
         C 0,0.974 0,0.87 0,0.5 
         C 0,0.13 0,0.026 0.06,0.014 
         C 0.13,0 0.4,0 0.5,0 
         Z"/>
      </clipPath>
      <clipPath id="panelClip" clipPathUnits="objectBoundingBox">
         <path d="
         M -0.2 -0.2 
         L 1.2 -0.2 
         L 1.2 0.72 
         L 0.855 0.72 
         C 0.815,0.72 0.785,0.74 0.75,0.77  
         C 0.715,0.8 0.68,0.825 0.64,0.825  
         L 0.36 0.825 
         C 0.32,0.825 0.285,0.8 0.25,0.77 
         C 0.215,0.74 0.185,0.72 0.145,0.72 
         L -0.2 0.72 
         Z"/>
      </clipPath>
    </defs>
  </svg>
  <div id="viewbox">
    <div id="channelViewBackground">
      <div id="channelView" onclick="gridOnClickHandler(null)"></div>
    </div>
    <div id="background">
      <div id="panel">
        <div id="wrapper">
          <div class="grid"><div class="gridInner empty"><div></div><hr></div></div>
          <div class="grid"><div class="gridInner empty"><div></div><hr></div></div>
          <div class="grid" openURL="res/channels/fireworks/fireworks.html">
            <iframe src="res/channels/fireworks/fireworksTile.html" frameborder="0"  class="gridInner"></iframe>
            <div class="iframeOverlay"></div>
          </div>
          <div class="grid"><div class="gridInner empty"><div></div><hr></div></div>
          <div class="grid"><div class="gridInner empty"><div></div><hr></div></div>
          <div class="grid"><div class="gridInner empty"><div></div><hr></div></div>
          <div class="grid"><div class="gridInner empty"><div></div><hr></div></div>
          <div class="grid"><div class="gridInner empty"><div></div><hr></div></div>
          <div class="grid"><div class="gridInner empty"><div></div><hr></div></div>
            <div class="grid" openURL="https://my.nintendo.com/">
              <iframe src="res/channels/myNintendo/tile/myNintendoTile.html" frameborder="0"  class="gridInner"></iframe>
              <div class="iframeOverlay"></div>
            </div>
          <div class="grid"><div class="gridInner empty"><div></div><hr></div></div>
          <div class="grid" openURL="https://github.com/MarkussLugia/MarkussLugia.github.io"><div id="github" class="gridInner"></div></div>
        </div>
        <img id="ampm" alt="时间更新脚本未成功加载" style="width: 3.5%; position: absolute; left: 38.5%; top: 74.5%;">
        <p class="time" id="hour">02</p>
        <p class="time" id="colon">:</p>
        <p class="time" id="minute">49</p>
      </div>
      <img id="panelBorder" src="res/panelBorder.svg">
      <img id="panelShadow" src="res/panelShadow.svg">
      <p id="date">11-28日(四)</p>
      <div id="backgroundTest"></div>
    </div>
  </div>
</body>
<script src="res/clickExtend.js" type="text/javascript"></script>
<script src="res/clockAnimation.js" type="text/javascript"></script>
<script type="text/javascript">
  var currentRect;
  let viewbox = document.getElementById("viewbox");
  let background = document.getElementById("background");
  let channelView = document.getElementById("channelView");
  function gridOnClickHandler(element) {
    clickExtend(element, background, viewbox);
    if (element.getAttribute("openURL") != null) {
      window.open(element.getAttribute("openURL"),'_self')
    }
  }

  Array.from(document.getElementsByClassName("grid")).forEach(function(element){
    element.onclick = function(){gridOnClickHandler(element)}
  });
  
  syncTime(document.getElementById("hour"),document.getElementById("minute"),document.getElementById("ampm"),document.getElementById("date"),true);
  tickAnimation(document.getElementById("colon"));

  Array.from(document.querySelectorAll(".empty div")).forEach(function(element){
    element.animate([
      {
        top: 0
      },
      {
        top: "-5.5%"
      }
    ],{
      duration:1600,
      easing: "linear",
      iterations: Infinity,
    })
  });
  Array.from(document.querySelectorAll(".empty hr")).forEach(function(element){
    element.animate([
      {
        top: "84%",
        opacity: 0
      },
      {
        opacity: 1,
        offset: 0.25
      },
      {
        opacity: 1,
        offset: 0.75
      },
      {
        top: "10%",
        opacity: 0
      }
    ],{
      duration:18000,
      easing: "linear",
      iterations: Infinity,
      delay: Math.random() * 18000
    })
  });
</script>
